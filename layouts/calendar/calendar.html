{{/* current series is the latest */}}
{{- $currentSeries := (index .Site.Taxonomies.series.Alphabetical.Reverse 0) -}}

{{/* load scratch with all items with showtimes */}}
{{/* one record for each showtime keyed on showtime */}}
{{- range $page := where $currentSeries.Pages.ByDate "Section" "in" (slice "show" "event") -}}
    {{- range .Params.showtimes -}}
        {{- $.Scratch.SetInMap "calendar" (.time.Unix | string) (dict "showtime" . "page" $page) -}}
    {{- end -}}
{{- end -}}

{{- partial "head.html" . -}}
{{- partial "nav_hidden.html" . -}}
<div id="panel">
{{- partial "nav.html" . -}}

{{ .Content }}

<!-- <div class="container">
	<h1>Upcoming Shows and Events</h1>
		{{/* all current pages in the "show" or "event" section */}}
		{{- range where $currentSeries.Pages.ByDate "Section" "in" (slice "show" "event") -}}
		<div class="show-card container-flex">
			<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
				{{ partial "show/poster.html" . }}
			</div>
				<div class="show-info col-xs-12 col-sm-12 col-md-8 col-lg-8">
						<h2>
								<a href="/{{ .Section }}/{{ .Params.series }}/{{ (.Title | urlize) }}">
										{{ .Title }}
								</a>
						</h2>
						<p>SEE IT LIVE<p>
						{{ partial "show/dates.html" . }}
				</div>
		</div>
		{{- end -}}
</div> -->

<ul>

{{- $.Scratch.Set "months" (slice) -}}
{{- range $weight, $dict := ($.Scratch.GetSortedMapValues "calendar") -}}
    {{- $.Scratch.Set "month" (dateFormat "January 2006" $dict.showtime.time) -}}
    {{- if not (in ($.Scratch.Get "months") ($.Scratch.Get "month")) -}}
        {{- $.Scratch.Add "months" ($.Scratch.Get "month") -}}
        <h2>
            {{ $.Scratch.Get "month" }}
        </h2>
    {{- end -}}
    <li>{{ $dict.showtime.time }} - {{ $dict.page.Title }}</li>
{{- end -}}
</ul>

</div>

{{ partial "foot.html" . }}
